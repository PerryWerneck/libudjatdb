<?xml version="1.0" encoding="UTF-8" ?>

<config>

	<module name='civetweb' required='no' />
	<module name='information' required='no' />

	<!--
		Use attribute for database URL to avoid repetitions.
	-->
	<attribute name='dburl' value='sqlite3:db=/tmp/test.db;@pool_size=10' />

	<!--
	
		Run SQL script on service startup.
	
	-->
	<sql type='initializer' connection='${dburl}' >
		create table if not exists urls (id integer primary key, inserted timestamp default CURRENT_TIMESTAMP, url text, action text, payload text)
	</sql>
	
	<!-- Create an SQL Based agent -->
	<sql name='urlcount' type='agent' value-type='integer' connection='${dburl}' retry-interval='14400' update-timer='14400'>
	
		<!-- Update agent value from SQL query -->
		<refresh connection='${dburl}'>
			select count (*) as value from urls;
		</refresh>
	
	</sql>
	
</config>

